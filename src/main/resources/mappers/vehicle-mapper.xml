<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="vehicle">

	<select id="selectList" resultType="VehicleInfo" >
		select v.*, f.type as fuelname, c.type as typename, l.name
		from FUELTYPE f, CARTYPE c, VEHICLE v ,location l
		where v.cartype_idx = c.idx and v.fueltype_idx = f.idx and v.location_idx=l.idx
	<if test="typeList !=null">
		and c.idx in
	 <foreach collection="typeList" item="type" separator="," open="(" close=")">
		#{type}
	 </foreach>
	</if>
		<if test="fuelList !=null">
		and f.idx in
	 <foreach collection="fuelList" item="fuel" separator=","  open="(" close=")">
		#{fuel}
	 </foreach>
	</if>
	
	</select>
	

	
	<select id="selectPageList" parameterType="map" resultType="VehicleInfo">
		 select v.*, f.type as fuelname, c.type as typename, l.name
		from FUELTYPE f, CARTYPE c, VEHICLE v ,location l
		where v.cartype_idx = c.idx and v.fueltype_idx = f.idx and v.location_idx=l.idx and v.idx BETWEEN #{start} and #{end}
	</select>

	<select id="selectOne" resultType="vehicleRespDto">
		SELECT * FROM VEHICLE WHERE IDX = #{IDX}
	</select>

	<resultMap type="VehicleReqDto" id="LocationInfo">
		<result property="idx" column="idx"/>
		<result property="locationidx" column="location_idx"/>
		<collection property="locationList" resultMap="locationInfo"></collection>
	</resultMap>


 	<select id="getVehicleInfo" resultType="VehicleInfo">
 		 select *
        from vehicle v
        left outer join location l
        on v.location_idx = l.idx
        where v.idx = #{idx}
 	</select>
 	
 	<select id="getOptionInfo" resultType="VehicleInfo">
	 select f.type as fuelname,  c.type as typename
	from FUELTYPE f, CARTYPE c, VEHICLE v
	where v.cartype_idx = c.idx and v.fueltype_idx = f.idx and v.idx=#{idx}
 	
 	</select>
 	<select id="selectOneCount" resultType="_int">
	select count(*) cnt from vehicle
	</select>
 	
 	
</mapper>
